name: Scheduled redeploy (Vercel)

on:
  push:
    branches:
      - main
  schedule:
    # GitHub Actions CRON UTC ile çalışır. TR (UTC+3) için saatler:
    # Yeni yayın planı: 09:00, 12:50, 15:25 (TR saati)
    # 09:00 TR -> 06:00 UTC
    - cron: '0 6 * * *'
    # 12:50 TR -> 09:50 UTC
    - cron: '50 9 * * *'
    # 15:25 TR -> 12:25 UTC
    - cron: '25 12 * * *'
  workflow_dispatch: {}

jobs:
  redeploy:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Vercel Deploy Hook
        env:
          HOOK: ${{ secrets.VERCEL_DEPLOY_HOOK }}
        run: |
          if [ -z "$HOOK" ]; then
            echo "VERCEL_DEPLOY_HOOK secret not set" >&2
            exit 1
          fi
          code=$(curl -s -o /dev/null -w "%{http_code}" -X POST "$HOOK")
          echo "HTTP $code"
          if [ "$code" -ge 200 ] && [ "$code" -lt 300 ]; then
            echo "Triggered successfully"
          else
            echo "Failed to trigger" >&2
            exit 1
          fi


