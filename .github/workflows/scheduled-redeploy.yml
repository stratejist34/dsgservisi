name: Scheduled redeploy (Vercel)

on:
  push:
    branches:
      - main
  schedule:
    # GitHub Actions CRON UTC ile çalışır. TR (UTC+3) için saatler:
    # Saat başı deployments: 10:00-19:00 TR
    - cron: '0 7 * * *'   # 10:00 TR
    - cron: '0 8 * * *'   # 11:00 TR
    - cron: '0 9 * * *'   # 12:00 TR
    - cron: '0 10 * * *'  # 13:00 TR
    - cron: '0 11 * * *'  # 14:00 TR
    - cron: '0 12 * * *'  # 15:00 TR
    - cron: '0 13 * * *'  # 16:00 TR
    - cron: '0 14 * * *'  # 17:00 TR
    - cron: '0 15 * * *'  # 18:00 TR
    - cron: '0 16 * * *'  # 19:00 TR
  workflow_dispatch: {}

jobs:
  redeploy:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Vercel Deploy Hook
        env:
          HOOK: ${{ secrets.VERCEL_DEPLOY_HOOK }}
        run: |
          if [ -z "$HOOK" ]; then
            echo "VERCEL_DEPLOY_HOOK secret not set" >&2
            exit 1
          fi
          code=$(curl -s -o /dev/null -w "%{http_code}" -X POST "$HOOK")
          echo "HTTP $code"
          if [ "$code" -ge 200 ] && [ "$code" -lt 300 ]; then
            echo "Triggered successfully"
          else
            echo "Failed to trigger" >&2
            exit 1
          fi


