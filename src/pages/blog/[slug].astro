---
import { getAllPostSlugs } from '@utils/wordpress';

export async function getStaticPaths() {
  try {
    const slugs = await getAllPostSlugs();
    return slugs.map((slug) => ({
      params: { slug },
    }));
  } catch (error) {
    console.log('WordPress API not available, skipping blog posts');
    return [];
  }
}

const { slug } = Astro.params;

// 301 Redirect from /blog/slug to /slug for SEO
return Astro.redirect(`/${slug}`, 301);
---
