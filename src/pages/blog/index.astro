---
export const prerender = false; // SSR mode for real-time blog posts

import BaseLayout from '@layouts/BaseLayout.astro';
import BlogCard from '@components/blog/BlogCard.astro';
import { fetchPosts } from '@utils/wordpress';

const seo = {
  title: 'Blog',
  description: 'DSG şanzıman, mekatronik sistemleri ve araç bakımı hakkında bilgilendirici yazılar, ipuçları ve güncellemeler.',
  url: '/blog',
};

// Fetch blog posts
const posts = await fetchPosts(1, 12);
---

<BaseLayout seo={seo}>
  <!-- Hero Section - Modern Premium -->
  <section class="relative min-h-[28vh] flex items-center justify-center overflow-hidden">
    {/* Background Image */}
    <div class="absolute inset-0">
      <img 
        src="/images/workshop.jpg" 
        alt="DSG Blog" 
        class="w-full h-full object-cover"
      />
      <div class="absolute inset-0 bg-gradient-to-br from-navy/95 via-navy/90 to-navy/95"></div>
    </div>

    {/* Animated Pattern */}
    <div class="absolute inset-0 opacity-10">
      <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,%3Csvg width=\'60\' height=\'60\' viewBox=\'0 0 60 60\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'none\' fill-rule=\'evenodd\'%3E%3Cg fill=\'%231a9cb0\' fill-opacity=\'0.4\'%3E%3Cpath d=\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
    </div>

    {/* Glowing Stars - Reduced */}
    <div class="absolute inset-0 overflow-hidden opacity-20">
      {Array.from({ length: 20 }).map((_, i) => (
        <div
          key={i}
          class="absolute w-1 h-1 bg-cyan rounded-full animate-glow-pulse"
          style={{
            left: `${Math.random() * 100}%`,
            top: `${Math.random() * 100}%`,
            animationDelay: `${Math.random() * 3}s`,
            animationDuration: `${2 + Math.random() * 2}s`,
          }}
        />
      ))}
    </div>

    <div class="container relative z-10 py-8">
      <div class="max-w-4xl mx-auto text-center">
        {/* Badge */}
        <div class="inline-flex items-center gap-2 bg-white/10 backdrop-blur-sm text-white px-6 py-2 rounded-full mb-3 animate-[fade-in-up_0.6s_ease-out]">
          <svg class="w-5 h-5 text-cyan" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
          </svg>
          <span class="font-semibold">Bilgi & İpuçları</span>
        </div>

        <h1 class="text-3xl md:text-4xl lg:text-5xl font-display font-bold text-white mb-3 animate-[fade-in-up_0.8s_ease-out]">
          DSG <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary via-cyan to-primary">Bilgi Merkezi</span>
        </h1>
        
        <p class="text-base md:text-lg text-gray-300 leading-relaxed max-w-3xl mx-auto animate-[fade-in-up_1s_ease-out]">
          DSG şanzıman, mekatronik sistemleri ve araç bakımı hakkında uzman görüşleri, 
          pratik ipuçları ve güncel haberler
        </p>
      </div>
    </div>
  </section>

  <!-- Blog Grid - CSS Pattern Based Layout -->
  <section class="section bg-gradient-to-b from-gray-50 to-white">
    <div class="container">
      {posts.length > 0 ? (
        <div class="max-w-[1400px] mx-auto">
          {/* CSS Grid: 12 kolonluk sistem, her satır 200px base */}
          <div class="grid grid-cols-1 md:grid-cols-12 gap-4 auto-rows-[200px]">
            {(() => {
              const elements = [];
              let i = 0;
              
              while (i < posts.length) {
                const cyclePosition = i % 11;
                
                // Pattern 1: Featured Large (8 col x 3 row) + 3x Featured Small (4 col x 1 row)
                if (cyclePosition === 0 && posts[i]) {
                  elements.push(
                    <div key={`featured-large-${i}`} class="md:col-span-8 md:row-span-3">
                      <BlogCard post={posts[i]} index={i} size="featured-large" />
                    </div>
                  );
                  i++;
                  
                  // 3 küçük kart sağda
                  for (let j = 0; j < 3 && posts[i]; j++) {
                    elements.push(
                      <div key={`featured-small-${i}`} class="md:col-span-4 md:row-span-1">
                        <BlogCard post={posts[i]} index={i} size="featured-small" />
                      </div>
                    );
                    i++;
                  }
                }
                // Pattern 2: Square Left (4 col x 2 row) + Rect Right (8 col x 2 row)
                else if (cyclePosition === 4 && posts[i]) {
                  elements.push(
                    <div key={`square-left-${i}`} class="md:col-span-4 md:row-span-2">
                      <BlogCard post={posts[i]} index={i} size="square-left" />
                    </div>
                  );
                  i++;
                  
                  if (posts[i]) {
                    elements.push(
                      <div key={`rect-right-${i}`} class="md:col-span-8 md:row-span-2">
                        <BlogCard post={posts[i]} index={i} size="rect-right" />
                      </div>
                    );
                    i++;
                  }
                }
                // Pattern 3: Rect Wide (8 col x 2 row) + 2x Square Stack (4 col x 1 row)
                else if (cyclePosition === 6 && posts[i]) {
                  elements.push(
                    <div key={`rect-wide-${i}`} class="md:col-span-8 md:row-span-2">
                      <BlogCard post={posts[i]} index={i} size="rect-wide" />
                    </div>
                  );
                  i++;
                  
                  // 2 kare kart sağda
                  for (let j = 0; j < 2 && posts[i]; j++) {
                    elements.push(
                      <div key={`square-stack-${i}`} class="md:col-span-4 md:row-span-1">
                        <BlogCard post={posts[i]} index={i} size="square-stack" />
                      </div>
                    );
                    i++;
                  }
                }
                // Pattern 4: 3x Regular Rect (4 col x 2 row each)
                else if (cyclePosition === 9 && posts[i]) {
                  for (let j = 0; j < 3 && posts[i]; j++) {
                    elements.push(
                      <div key={`rect-regular-${i}`} class="md:col-span-4 md:row-span-2">
                        <BlogCard post={posts[i]} index={i} size="rect-regular" />
                      </div>
                    );
                    i++;
                  }
                }
                else {
                  i++;
                }
              }
              
              return elements;
            })()}
          </div>
        </div>
      ) : (
        <div class="text-center py-20">
          <div class="relative inline-block mb-6">
            <div class="w-24 h-24 bg-gradient-to-br from-primary/20 to-cyan/20 rounded-2xl flex items-center justify-center mx-auto">
              <svg class="w-12 h-12 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
              </svg>
            </div>
          </div>
          <h3 class="text-3xl font-display font-bold text-navy mb-4">Henüz Blog Yazısı Yok</h3>
          <p class="text-lg text-gray-600 mb-8 max-w-md mx-auto">
            Yakında burada DSG şanzıman ve araç bakımı hakkında faydalı içerikler paylaşılacak
          </p>
          <div class="flex gap-4 justify-center">
            <a href="/" class="btn bg-gradient-to-r from-primary to-cyan text-white hover:shadow-lg hover:shadow-primary/50 transition-all">
              Ana Sayfaya Dön
            </a>
            <a href="/hizmetlerimiz" class="btn bg-white text-navy border-2 border-navy hover:bg-navy hover:text-white transition-all">
              Hizmetlerimiz
            </a>
          </div>
        </div>
      )}
    </div>
  </section>

  <!-- CTA Section - Modern -->
  <section class="section relative bg-gradient-to-br from-navy via-navy-600 to-navy overflow-hidden">
    {/* Animated Background */}
    <div class="absolute inset-0 opacity-20">
      <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,%3Csvg width=\'60\' height=\'60\' viewBox=\'0 0 60 60\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'none\' fill-rule=\'evenodd\'%3E%3Cg fill=\'%231a9cb0\' fill-opacity=\'0.4\'%3E%3Cpath d=\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E'); animation: slide-bg 30s linear infinite;"></div>
    </div>

    {/* Gradient Orbs */}
    <div class="absolute top-20 left-10 w-96 h-96 bg-primary/30 rounded-full blur-3xl animate-float"></div>
    <div class="absolute bottom-20 right-10 w-80 h-80 bg-cyan/30 rounded-full blur-3xl animate-float" style="animation-delay: 2s;"></div>

    <div class="container relative z-10">
      <div class="max-w-3xl mx-auto text-center">
        {/* Icon */}
        <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-primary to-cyan rounded-2xl mb-6 shadow-xl">
          <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
        </div>

        <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-bold text-white mb-6">
          Aracınız İçin <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary via-cyan to-primary">Profesyonel Hizmet</span>
        </h2>
        
        <p class="text-lg md:text-xl text-white/90 mb-10 leading-relaxed">
          DSG şanzıman ve mekatronik uzmanlarımızla tanışın. 
          <span class="text-cyan font-semibold">15 yıllık deneyim</span> ve 
          <span class="text-cyan font-semibold">6500+ mutlu müşteri</span>
        </p>
        
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a
            href="/iletisim"
            class="group relative inline-flex items-center justify-center gap-2 bg-gradient-to-r from-primary to-cyan text-white px-8 py-4 rounded-xl font-semibold text-lg shadow-xl hover:shadow-2xl hover:shadow-primary/50 transition-all duration-300 hover:-translate-y-1"
          >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
            </svg>
            Hemen Ara
            <svg class="w-5 h-5 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
            </svg>
          </a>
          <a
            href="/hizmetlerimiz"
            class="group inline-flex items-center justify-center gap-2 bg-white/10 backdrop-blur-sm text-white border-2 border-white/30 hover:bg-white hover:text-navy px-8 py-4 rounded-xl font-semibold text-lg transition-all duration-300 hover:-translate-y-1"
          >
            Hizmetlerimiz
            <svg class="w-5 h-5 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
            </svg>
          </a>
        </div>

        {/* Stats */}
        <div class="grid grid-cols-3 gap-6 mt-12 pt-12 border-t border-white/20">
          <div class="text-center">
            <div class="text-3xl md:text-4xl font-display font-black text-white mb-2">15+</div>
            <div class="text-sm text-white/80">Yıl Deneyim</div>
          </div>
          <div class="text-center">
            <div class="text-3xl md:text-4xl font-display font-black text-white mb-2">6.5K+</div>
            <div class="text-sm text-white/80">Mutlu Müşteri</div>
          </div>
          <div class="text-center">
            <div class="text-3xl md:text-4xl font-display font-black text-white mb-2">8</div>
            <div class="text-sm text-white/80">Premium Marka</div>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  @keyframes slide-bg {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(60px);
    }
  }

  @keyframes glow-pulse {
    0%, 100% {
      opacity: 0.2;
      transform: scale(1);
    }
    50% {
      opacity: 1;
      transform: scale(1.5);
    }
  }
</style>

